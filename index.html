<!DOCTYPE html>
<html>
<head>
    <title>Receiver</title>
    <style>
        #messageLog {
            padding: 10px;
            margin: 10px 0;
            border: 1px solid #eee;
            min-height: 100px;
        }
    </style>
</head>
<body>
    <h1>PostMessage Receiver</h1>
    <div id="messageLog">Aguardando mensagens...</div>
    
    <script>
        // Função para mostrar mensagens recebidas
        function displayMessage(data) {
            const log = document.getElementById('messageLog');
            const messageElement = document.createElement('div');
            messageElement.innerHTML = `
                <p><strong>${new Date().toLocaleTimeString()}</strong></p>
                <pre>${JSON.stringify(data, null, 2)}</pre>
                <hr>
            `;
            
            if (log.firstChild.textContent === "Aguardando mensagens...") {
                log.innerHTML = '';
            }
            
            log.prepend(messageElement);
        }

        // Listener para mensagens
        window.addEventListener('message', function(event) {
            // Verifica a origem para segurança
            if (event.origin.includes('lowcoder') || 
                event.origin === window.location.origin) {
                
                // Mostra a mensagem recebida
                displayMessage(event.data);
                
                // Resposta opcional
                if (event.data && event.data.type) {
                    event.source.postMessage({
                        type: 'ACKNOWLEDGE',
                        received: true,
                        yourMessage: event.data
                    }, event.origin);
                }
            }
        });
        
        console.log('Receiver pronto na origem:', window.location.origin);
    </script>
</body>
</html>
